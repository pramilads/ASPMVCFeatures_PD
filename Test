import { Component, Input } from '@angular/core';
import { NgbActiveModal } from '@ng-bootstrap/ng-bootstrap';
import { SchedulerService } from 'src/app/core/services/scheduler.service';
import { CrewUpdateModel } from './../../../shared/models/search.model';

@Component({
  selector: 'employee-edit',
  templateUrl: './employee-edit.component.html'
})
export class EmployeeEditComponent {
  @Input() public inputEmployeeInfo: any;
  dropDownData : any;
  isActive: boolean;
  crewUpdateModel: CrewUpdateModel;

  constructor(public activeModal: NgbActiveModal, private schedulerService: SchedulerService){
  }

  ngOnInit() {
    this.getDataForDropDowns();
    this.isActive = this.inputEmployeeInfo.status == 'Active' ? true : false;
  }

  getDataForDropDowns(){
    this.schedulerService.getCrewType().subscribe(
      (res) => {
        this.dropDownData = res.dropdownDetails;
      }
    );
  }

  updateCrewInfo(){
    this.crewUpdateModel = new CrewUpdateModel();
    this.crewUpdateModel.Active = this.isActive ? 1 : 0;
    this.crewUpdateModel.EmployeeClassficationId = this.inputEmployeeInfo.employeeTypeId;
    this.crewUpdateModel.Id = this.inputEmployeeInfo.id;
    this.schedulerService.updateCrewInfo(this.crewUpdateModel).subscribe(
      (res) => {
        console.log(res);
        this.activeModal.close('save');
      }
    )
  }
}
